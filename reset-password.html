<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nature Craft Store - Reset Password</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<header class="main-header">
    <div class="logo">
        <a href="home.html">
            <img src="logo.jpeg" alt="Nature Craft Store Logo">
        </a>
        <span>Nature Craft Store</span>
    </div>
</header>

<div class="form-container">
    <h2>Reset Password</h2>

    <form id="resetForm">
        <input type="password" id="newPassword" placeholder="New Password" required>
        <input type="password" id="confirmPassword" placeholder="Confirm New Password" required>
        <button type="submit">Reset Password</button>
    </form>
</div>

<script>
document.getElementById("resetForm").addEventListener("submit", function (e) {
    e.preventDefault();

    const newPass = document.getElementById("newPassword").value;
    const confirmPass = document.getElementById("confirmPassword").value;

    if (newPass !== confirmPass) {
        alert("Passwords do not match!");
        return;
    }

    if (newPass.length < 6) {
        alert("Password must be at least 6 characters!");
        return;
    }

    // GET USERS ARRAY
    let users = JSON.parse(localStorage.getItem("users")) || [];
    const index = localStorage.getItem("resetUserIndex");

    if (index === null || !users[index]) {
        alert("Invalid or expired reset request!");
        window.location.href = "forgot-password.html";
        return;
    }

    // UPDATE PASSWORD
    users[index].password = newPass;
    localStorage.setItem("users", JSON.stringify(users));

    // CLEANUP
    localStorage.removeItem("resetUserIndex");

    alert("Password reset successful!");
    window.location.href = "login.html";
});
</script>

</body>
</html>
